##Configurations

###Derby
Go to %JAVA_HOME%/db/bin.
Execute the "startNetWorkServer" script and watch out for the derby instance to start.
Now open another CMD prompt also navigate to the db/bin folder and execute the "ij" script.
This should come up with a prompt " ij>. Now enter the following connect string:

connect 'jdbc:derby://localhost:1527/JAVAEEEXAMPLE;create=true';

Now add the changelog table, this is used by dbdeploy for versioning.
CREATE TABLE changelog ( change_number DECIMAL(22,0) NOT NULL, complete_dt TIMESTAMP NOT NULL, applied_by VARCHAR(100) NOT NULL, description VARCHAR(500) NOT NULL );
ALTER TABLE changelog ADD CONSTRAINT Pkchangelog PRIMARY KEY (change_number);

###Glassfish

* Create a new domain called "test-domain":

Navigate to %GLASSFISH_HOME%/bin and use the following command:
asadmin create-domain --portbase 10000 --nopassword test-domain

* Add database as a connection pool:

Navigate to %GLASSFISH_HOME%/glassfish/domains/test-domain
 and open the config/domain.xml file.
Add a derby database as a connection pool to the domain:

<jdbc-connection-pool driver-classname="" datasource-classname=
"org.apache.derby.jdbc.ClientDataSource40" res-type="javax.sql.DataSource"
 description="" name="JavaEEPool" ping="true">
      <property name="User" value="APP"></property>
      <property name="DatabaseName" value="JAVAEEEXAMPLE"></property>
      <property name="RetrieveMessageText" value="true"></property>
      <property name="Password" value="APP"></property>
      <property name="ServerName" value="localhost"></property>
      <property name="Ssl" value="off"></property>
      <property name="SecurityMechanism" value="4"></property>
      <property name="TraceFileAppend" value="false"></property>
      <property name="TraceLevel" value="-1"></property>
      <property name="PortNumber" value="1527"></property>
      <property name="LoginTimeout" value="0"></property>
</jdbc-connection-pool>
<jdbc-resource pool-name=">JavaEEPool" description="" jndi-name="jdbc/javaeeDS"></jdbc-resource>

Find the <config name="server-config"> element and inside it look for the last <resource-ref entry.
Add the following line there:

<resource-ref ref="jdbc/galleriaDS"></resource-ref>

Finally look for the </auth-realm> element and add the following:

<auth-realm classname="com.sun.enterprise.security.auth.realm.jdbc.JDBCRealm" name="JavaEERealm">
      <property name="jaas-context" value="jdbcRealm"></property>
      <property name="encoding" value="Hex"></property>
      <property name="password-column" value="PASSWORD"></property>
      <property name="datasource-jndi" value="jdbc/javaeeDS"></property>
      <property name="group-table" value="USERS_GROUPS"></property>
      <property name="charset" value="UTF-8"></property>
      <property name="user-table" value="USERS"></property>
      <property name="group-name-column" value="GROUPID"></property>
      <property name="digest-algorithm" value="SHA-512"></property>
      <property name="user-name-column" value="USERID"></property>
</auth-realm>